apiVersion: kustomize.config.k8s.io/v1beta1
configMapGenerator:
- behavior: merge
  name: argocd-cm
  literals:
  - |
    repository.credentials=- passwordSecret:
        key: git_token
        name: autopilot-secret
      url: https://github.com/
      usernameSecret:
        key: git_username
        name: autopilot-secret
- behavior: merge
  name: argocd-cm
  literals:
  - |
    dex.config=connectors:
      - type: oauth
        id: vault
        name: Vault
        config:
          clientID: vzs7h6HINWYepuD9A09RfKbn5owAIAfE
          clientSecret: hvo_secret_xn0vuvVfjITei4lMIyhbPqXi0Qp4UoJXagb0eBsGUOga7l8DSYRBbebMBDzzog1P
          redirectURI: https://fmt2-argo.generalprogramming.org/api/dex/callback

          tokenURL: https://vault-proxy.catgirls.dev:8200/v1/identity/oidc/provider/default/token
          authorizationURL: https://vault-proxy.catgirls.dev:8200/ui/vault/identity/oidc/provider/default/authorize
          userInfoURL: https://vault-proxy.catgirls.dev:8200/v1/identity/oidc/provider/default/userinfo
          claimMapping:
            userNameKey: username
            groupsKey: groups
            emailKey: email
kind: Kustomization
namespace: argocd
resources:
- github.com/argoproj-labs/argocd-autopilot/manifests/base?ref=v0.4.15
